package persistidor.comandos;

import java.lang.reflect.Field;
import java.util.ArrayList;
import java.util.List;
import org.springframework.stereotype.Component;
import persistidor.entidades.Atributo;
import persistidor.entidades.Clase;
import persistidor.excepciones.TipoOValorInvalidoException;

@Component
public class CrearEntidadClaseDesdeClassComando implements ICrearEntidadClaseDesdeClassComando
{
	public Clase ejecutar(Class clase) throws TipoOValorInvalidoException
	{
		return ejecutar(clase, new ArraytList<Clase>());
	}
	
	private Clase ejecutar(Class clase, List<Clase> entidadesClaseYaCreadas) throws TipoOValorInvalidoException
	{
		String nombreDeClase = clase.getName();
		Field[] atributos = clase.getDeclaredFields();
		List<Atributo> entidadesAtributos = new ArrayList<Atributo>();

		for (Field atributo : atributos)
		{
			Atributo entidadAtributo = crearEntidadAtributo(atributo, entidadesClaseYaCreadas);
			entidadesAtributos.add(entidadAtributo);
		}
		
		return new Clase(nombreDeClase, entidadesAtributos);
	}
}
